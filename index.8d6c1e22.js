!function(){function e(e){return e&&e.__esModule?e.default:e}var t={};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var i={};function a(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(e,t,i){t&&a(e.prototype,t);i&&a(e,i);return e};var c={};Object.defineProperty(c,"__esModule",{value:!0}),c.default=function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i;return e};var n=function(){"use strict";function a(){e(t)(this,a),e(c)(this,"score",0),e(c)(this,"lines",0),e(c)(this,"level",0),e(c)(this,"playfield",this.createPlayfield()),e(c)(this,"activePiece",this.createPiece()),e(c)(this,"nextPiece",this.createPiece())}return e(i)(a,[{key:"getState",value:function(){for(var e=this.createPlayfield(),t=this.activePiece,i=t.y,a=t.x,c=t.blocks,n=0;n<this.playfield.length;n++){e[n]=[];for(var r=0;r<this.playfield[n].length;r++)e[n][r]=this.playfield[n][r]}for(var o=0;o<c.length;o++)for(var l=0;l<c[o].length;l++)c[o][l]&&(e[i+o][a+l]=c[o][l]);return{playfield:e}}},{key:"createPlayfield",value:function(){for(var e=[],t=0;t<20;t++){e[t]=[];for(var i=0;i<10;i++)e[t][i]=0}return e}},{key:"createPiece",value:function(){var e={};switch("IJLOSTZ"[Math.floor(7*Math.random())]){case"I":e.blocks=[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]];break;case"J":e.blocks=[[0,0,0],[2,2,2],[0,0,2]];break;case"L":e.blocks=[[0,0,0],[3,3,3],[3,0,0]];break;case"O":e.blocks=[[0,0,0,0],[0,4,4,0],[0,4,4,0],[0,0,0,0]];break;case"S":e.blocks=[[0,0,0],[0,5,5],[5,5,0]];break;case"T":e.blocks=[[0,0,0],[6,6,6],[0,6,0]];break;case"Z":e.blocks=[[0,0,0],[7,7,0],[0,7,7]];break;default:throw new Error("Unknown type of figure")}return e.x=Math.floor((10-e.blocks[0].length)/2),e.y=0,e}},{key:"movePieceLeft",value:function(){this.activePiece.x-=1,this.hasCollision()&&(this.activePiece.x+=1)}},{key:"movePieceRight",value:function(){this.activePiece.x+=1,this.hasCollision()&&(this.activePiece.x-=1)}},{key:"movePieceDown",value:function(){this.activePiece.y+=1,this.hasCollision()&&(this.activePiece.y-=1,this.lockPiece(),this.updatePieces())}},{key:"rotatePiece",value:function(){this.rotateBlocks(),this.hasCollision()&&this.rotateBlocks(!1)}},{key:"rotateBlocks",value:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.activePiece.blocks,i=t.length,a=Math.floor(i/2),c=i-1,n=0;n<a;n++)for(var r=n;r<c-n;r++){var o=t[n][r];e?(t[n][r]=t[c-r][n],t[c-r][n]=t[c-n][c-r],t[c-n][c-r]=t[r][c-n],t[r][c-n]=o):(t[n][r]=t[r][c-n],t[r][c-n]=t[c-n][c-r],t[c-n][c-r]=t[c-r][n],t[c-r][n]=o)}}},{key:"hasCollision",value:function(){for(var e=this.activePiece,t=e.y,i=e.x,a=e.blocks,c=0;c<a.length;c++)for(var n=0;n<a.length;n++)if(a[c][n]&&(void 0===this.playfield[t+c]||void 0===this.playfield[t+c][i+n]||this.playfield[t+c][i+n]))return!0;return!1}},{key:"lockPiece",value:function(){for(var e=this.activePiece,t=e.y,i=e.x,a=e.blocks,c=0;c<a.length;c++)for(var n=0;n<a.length;n++)a[c][n]&&(this.playfield[t+c][i+n]=a[c][n])}},{key:"updatePieces",value:function(){this.activePiece=this.nextPiece,this.nextPiece=this.createPiece()}}]),a}(),r=function(){"use strict";function a(i,c,n,r,o){e(t)(this,a),this.element=i,this.width=c,this.height=n,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.context=this.canvas.getContext("2d"),this.blockWidth=this.width/o,this.blockHeight=this.height/r,this.element.appendChild(this.canvas)}return e(i)(a,[{key:"render",value:function(e){var t=e.playfield;this.clearScreen(),this.renderPlayfield(t)}},{key:"clearScreen",value:function(){this.context.clearRect(0,0,this.width,this.height)}},{key:"renderPlayfield",value:function(e){for(var t=0;t<e.length;t++)for(var i=e[t],c=0;c<i.length;c++){var n=i[c];n&&this.renderBlock(c*this.blockWidth,t*this.blockHeight,this.blockWidth,this.blockHeight,a.colors[n])}}},{key:"renderBlock",value:function(e,t,i,a,c){this.context.fillStyle=c,this.context.strokeStyle="black",this.context.lineWidth=2,this.context.fillRect(e,t,i,a),this.context.strokeRect(e,t,i,a)}}]),a}();e(c)(r,"colors",{1:"cyan",2:"blue",3:"orange",4:"yellow",5:"green",6:"purple",7:"red"});var o=document.querySelector("#root"),l=new n,s=new r(o,320,640,20,10);window.game=l,window.view=s,document.addEventListener("keydown",(function(e){switch(e.keyCode){case 37:l.movePieceLeft(),s.render(l.getState());break;case 38:l.rotatePiece(),s.render(l.getState());break;case 39:l.movePieceRight(),s.render(l.getState());break;case 40:l.movePieceDown(),s.render(l.getState())}}))}();
//# sourceMappingURL=index.8d6c1e22.js.map
