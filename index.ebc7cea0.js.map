{"mappings":"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","sources":["node_modules/@swc/helpers/lib/_class_call_check.js","node_modules/@swc/helpers/lib/_create_class.js","node_modules/@swc/helpers/lib/_define_property.js","src/game.js","<<jsx-config-pragma.js>>","src/view.js","src/index.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _classCallCheck;\nfunction _classCallCheck(instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n        throw new TypeError(\"Cannot call a class as a function\");\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _createClass;\nfunction _createClass(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n    return Constructor;\n}\nfunction _defineProperties(target, props) {\n    for(var i = 0; i < props.length; i++){\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = _defineProperty;\nfunction _defineProperty(obj, key, value) {\n    if (key in obj) {\n        Object.defineProperty(obj, key, {\n            value: value,\n            enumerable: true,\n            configurable: true,\n            writable: true\n        });\n    } else {\n        obj[key] = value;\n    }\n    return obj;\n}\n","export default class Game {\n  score = 0;\n  lines = 0;\n  level = 0;\n  playfield = this.createPlayfield();\n  activePiece = {\n    x: 0,\n    y: 0,\n    blocks: [\n      [0, 1, 0],\n      [1, 1, 1],\n      [0, 0, 0],\n    ],\n  };\n\n  getState() {\n    const playfield = this.createPlayfield();\n    const { y: pieceY, x: pieceX, blocks } = this.activePiece;\n\n    for (let y = 0; y < this.playfield.length; y++) {\n      playfield[y] = [];\n\n      for (let x = 0; x < this.playfield[y].length; x++) {\n        playfield[y][x] = this.playfield[y][x];\n      }\n    }\n\n    for (let y = 0; y < blocks.length; y++) {\n      for (let x = 0; x < blocks[y].length; x++) {\n        if (blocks[y][x]) {\n          playfield[pieceY + y][pieceX + x] = blocks[y][x];\n        }\n      }\n    }\n\n    return {\n      playfield,\n    };\n  }\n\n  createPlayfield() {\n    const playfield = [];\n\n    for (let y = 0; y < 20; y++) {\n      playfield[y] = [];\n\n      for (let x = 0; x < 10; x++) {\n        playfield[y][x] = 0;\n      }\n    }\n\n    return playfield;\n  }\n\n  movePieceLeft() {\n    this.activePiece.x -= 1;\n\n    if (this.hasCollision()) {\n      this.activePiece.x += 1;\n    }\n  }\n\n  movePieceRight() {\n    this.activePiece.x += 1;\n\n    if (this.hasCollision()) {\n      this.activePiece.x -= 1;\n    }\n  }\n\n  movePieceDown() {\n    this.activePiece.y += 1;\n\n    if (this.hasCollision()) {\n      this.activePiece.y -= 1;\n      this.lockPiece();\n    }\n  }\n\n  rotatePiece() {\n    this.rotateBlocks();\n\n    if (this.hasCollision()) {\n      this.rotateBlocks(false);\n    }\n  }\n\n  rotateBlocks(clockwise = true) {\n    const blocks = this.activePiece.blocks;\n    const length = blocks.length;\n    const x = Math.floor(length / 2);\n    const y = length - 1;\n\n    for (let i = 0; i < x; i++) {\n      for (let j = i; j < y - i; j++) {\n        const temp = blocks[i][j];\n\n        if (clockwise) {\n          blocks[i][j] = blocks[y - j][i];\n          blocks[y - j][i] = blocks[y - i][y - j];\n          blocks[y - i][y - j] = blocks[j][y - i];\n          blocks[j][y - i] = temp;\n        } else {\n          blocks[i][j] = blocks[j][y - i];\n          blocks[j][y - i] = blocks[y - i][y - j];\n          blocks[y - i][y - j] = blocks[y - j][i];\n          blocks[y - j][i] = temp;\n        }\n      }\n    }\n  }\n\n  hasCollision() {\n    const { y: pieceY, x: pieceX, blocks } = this.activePiece;\n\n    for (let y = 0; y < blocks.length; y++) {\n      for (let x = 0; x < blocks.length; x++) {\n        if (\n          blocks[y][x] &&\n          (this.playfield[pieceY + y] === undefined ||\n            this.playfield[pieceY + y][pieceX + x] === undefined ||\n            this.playfield[pieceY + y][pieceX + x])\n        ) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  lockPiece() {\n    const { y: pieceY, x: pieceX, blocks } = this.activePiece;\n\n    for (let y = 0; y < blocks.length; y++) {\n      for (let x = 0; x < blocks.length; x++) {\n        if (blocks[y][x]) {\n          this.playfield[pieceY + y][pieceX + x] = blocks[y][x];\n        }\n      }\n    }\n  }\n}\n",null,"export default class View {\n  constructor(element, width, height, rows, columns) {\n    this.element = element;\n    this.width = width;\n    this.height = height;\n\n    this.canvas = document.createElement('canvas');\n    this.canvas.width = this.width;\n    this.canvas.height = this.height;\n    this.context = this.canvas.getContext('2d');\n\n    this.blockWidth = this.width / columns;\n    this.blockHeight = this.height / rows;\n\n    this.element.appendChild(this.canvas);\n  }\n\n  render({ playfield }) {\n    this.clearScreen();\n    this.renderPlayfield(playfield);\n  }\n\n  clearScreen() {\n    this.context.clearRect(0, 0, this.width, this.height);\n  }\n\n  renderPlayfield(playfield) {\n    for (let y = 0; y < playfield.length; y++) {\n      const line = playfield[y];\n\n      for (let x = 0; x < line.length; x++) {\n        const block = line[x];\n\n        if (block) {\n          this.renderBlock(\n            x * this.blockWidth,\n            y * this.blockHeight,\n            this.blockWidth,\n            this.blockHeight,\n            'red'\n          );\n        }\n      }\n    }\n  }\n\n  renderBlock(x, y, width, height, color) {\n    this.context.fillStyle = color;\n    this.context.strokeStyle = 'black';\n    this.context.lineWidth = 2;\n\n    this.context.fillRect(x, y, width, height);\n    this.context.strokeRect(x, y, width, height);\n  }\n}\n","import Game from './game';\nimport View from './view';\n\nconst root = document.querySelector('#root');\n\nconst game = new Game();\nconst view = new View(root, 320, 640, 20, 10);\n\nwindow.game = game;\nwindow.view = view;\n\ndocument.addEventListener(\"keydown\", event => {\n    switch (event.keyCode) {\n        case 37: // LEFT ARROW\n            game.movePieceLeft();\n            view.render(game.getState());\n            break;\n        case 38: // UP ARROW\n            game.rotatePiece();\n            view.render(game.getState());\n            break;\n        case 39: // RIGHT ARROW\n            game.movePieceRight();\n            view.render(game.getState());\n            break;\n        case 40: // DOWN ARROW\n            game.movePieceDown();\n            view.render(game.getState());\n            break;\n    }\n})\n\n"],"names":["Object","defineProperty","$665014edacbfe17b$exports","value","default","instance","Constructor","TypeError","$74e7f8130373505f$var$_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","$74e7f8130373505f$exports","protoProps","staticProps","prototype","$cec85eba0a352189$exports","obj","$99d08c4d6b37c7ca$export$2e2bcd8739ae039","Game","$parcel$interopDefault","this","createPlayfield","x","y","blocks","playfield","_activePiece","activePiece","pieceY","pieceX","y1","x1","hasCollision","lockPiece","rotateBlocks","clockwise","arguments","Math","floor","j","temp","undefined","$5d49d22315d62564$export$2e2bcd8739ae039","View","element","width","height","rows","columns","canvas","document","createElement","context","getContext","blockWidth","blockHeight","appendChild","param","clearScreen","renderPlayfield","clearRect","line","renderBlock","color","fillStyle","strokeStyle","lineWidth","fillRect","strokeRect","$b8f9b7833fa37166$var$root","querySelector","$b8f9b7833fa37166$var$game","$b8f9b7833fa37166$var$view","window","game","view","addEventListener","event","keyCode","movePieceLeft","render","getState","rotatePiece","movePieceRight","movePieceDown"],"version":3,"file":"index.ebc7cea0.js.map"}